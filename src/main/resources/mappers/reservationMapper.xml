<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 예약 네임스페이스(사용영역) 설정 -->
<mapper namespace="com.gsitm.mrs.mappers.ReservationMapper">

	<!-- 승인 대기 목록 조회 -->
	<select id="getWaitingList" resultType="Map">
		SELECT r.res_no         AS reservationNo, 
		       w.mgr_approval   AS managerApproval, 
		       w.admin_approval AS adminApproval, 
		       r.name           AS resName, 
		       r.purpose, 
		       room.name        AS roomName, 
		       r."start", 
		       r."end", 
		       e.name           AS empName, 
		       e2.name          AS mgrName 
		FROM   waiting w, 
		       reservation r, 
		       room room, 
		       employee e, 
		       employee e2 
		WHERE  w.res_no = r.res_no 
		       AND r.room_no = room.room_no 
		       AND r.emp_no = e.emp_no 
		       AND e.mgr_no = e2.emp_no 
		       AND ( w.mgr_approval = 'W' 
		              OR w.admin_approval = 'W' ) 
	</select>
	
</mapper>